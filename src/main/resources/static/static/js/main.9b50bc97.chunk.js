(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{190:function(e,t,a){e.exports=a(405)},195:function(e,t,a){},199:function(e,t,a){},271:function(e,t,a){},405:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),l=a(9),i=a.n(l),p=(a(195),a(42)),c=a(43),o=a(46),r=a(44),m=a(45);n.Component,Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(197),a(199);var u=a(407),d=a(417),f=a(127),h=a(55),E=a(412),g=a(411),v=a(409),b=a(11),A=a(25),y=a(408),w=a(410),k=a(92),L=a.n(k),S=a(173),C=a.n(S),O=a(414),j={success:200,fail:400,error:500,msg:function(e){200==e.code?O.a.success(e.message):400==e.code?O.a.error(e.message):O.a.error("\u7cfb\u7edf\u5f02\u5e38")}};L.a.defaults.timeout=1e5;var N={wsUrl:"ws://"+window.location.host,post:function(e,t){return new Promise(function(a,n){L.a.post(e,C.a.stringify(t),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){j.msg(e.data),a(e.data)}).catch(function(e){j.msg({code:500}),n(e)})})},get:function(e,t){return new Promise(function(a,n){L.a.get(e,{params:t}).then(function(e){a(e.data)}).catch(function(e){n(e)})})}},x={selectListDataProcessing:function(e){e.data.pageSize=e.data.size,e.data.size=null},selectAppList:function(e){return N.post("aptsApp/selectAppList",e)},saveApp:function(e){return N.post("aptsApp/saveApp",e)},deleteApp:function(e){return N.post("aptsApp/deleteApp",e)},getApp:function(e){return N.post("aptsApp/getApp",e)},startApp:function(e){return N.post("aptsApp/startApp",e)},stopApp:function(e){return N.post("aptsApp/stopApp",e)}},I=(a(271),E.a.Search),T=g.a.confirm,M=v.a.Item,W={labelCol:{xs:{span:10},sm:{span:8}},wrapperCol:{xs:{span:10},sm:{span:10}}},z={token:"cnm"},D=function(e){function t(e){var a,n;return Object(p.a)(this,t),(n=Object(o.a)(this,Object(r.a)(t).call(this,e))).state={pagination:{records:[]},loading:!1,appList:{current:1,size:10,name:""},app:{id:"",name:"",fileName:""},modal:{title:""},wsList:[]},n.handleChange=function(e){var t=e.fileList;t=(t=(t=t.slice(-1)).map(function(e){return e.response&&(e.name=e.response.data[0]),e})).filter(function(e){return!e.response||200===e.response.code}),n.setState({app:{id:n.state.app.id,fileName:t,name:n.state.app.name}})},n.selectAppList=function(){n.setState({loading:!0}),x.selectAppList(n.state.appList).then(function(e){200==e.code&&(x.selectListDataProcessing(e),n.setState({loading:!1,pagination:e.data}))})},n.printState=function(e){return 0==e?s.a.createElement("span",null,s.a.createElement(b.a,{type:"play-circle"})," \u5f85\u8fd0\u884c"):1==e?s.a.createElement("span",null,s.a.createElement(b.a,{type:"loading"})," \u542f\u52a8\u4e2d"):2==e?s.a.createElement("span",null,s.a.createElement(b.a,{type:"pause-circle"})," \u5df2\u8fd0\u884c"):void 0},n.printOperation=function(e){var t=e.state,a=e.id;if(1==t){var l=!0;if(n.state.wsList.map(function(e){e==a&&(l=!1)}),l){n.state.wsList.push(a);var i=new WebSocket(N.wsUrl+"/aptsAppWs/"+a),p=Object(h.a)(Object(h.a)(n));i.onmessage=function(t){var n=JSON.parse(t.data);200==n.code?(e.state=2,p.setState({appList:p.state.appList}),j.msg({code:200,message:e.name+" \u5df2\u6210\u529f\u8fd0\u884c"}),this.close()):400==n.code&&(e.state=0,p.setState({appList:p.state.appList}),j.msg({code:400,message:e.name+" \u8fd0\u884c\u5931\u8d25"}),this.close());for(var s=p.state.wsList,l=0;l<s.length;l++){if(s[l]==a){s.splice(l,1);break}}}}}var c=s.a.createElement("span",{className:"ad"},"\u7f16\u8f91"),o=s.a.createElement("span",{className:"ad"},"\u8fd0\u884c"),r=s.a.createElement("a",{className:"aptsA",onClick:function(){return n.appStop(a,e)}},"\u505c\u6b62"),m=s.a.createElement("span",{className:"ad"},"\u5220\u9664");return 0==t&&(c=s.a.createElement("a",{className:"aptsA",onClick:function(){return n.appEdit(a)}},"\u7f16\u8f91"),o=s.a.createElement("a",{className:"aptsA",onClick:function(){return n.appStart(a,e)}},"\u8fd0\u884c"),r=s.a.createElement("span",{className:"ad"},"\u505c\u6b62"),m=s.a.createElement("a",{className:"aptsA",onClick:function(){return n.appDel(a)}},"\u5220\u9664")),s.a.createElement("span",null,c,s.a.createElement("span",null," | "),o,s.a.createElement("span",null," | "),r,s.a.createElement("span",null," | "),m,s.a.createElement("span",null," | "),s.a.createElement("a",{className:"aptsA",onClick:function(){return n.selectLog(a)}},"\u67e5\u770b\u5b9e\u65f6\u65e5\u5fd7"))},n.selectLog=function(e){window.open("/#/log/"+e)},n.appEdit=function(e){n.showModal(1,e)},n.appStart=function(e,t){x.startApp({id:e}).then(function(e){200==e.code&&(t.state=1,n.setState({appList:n.state.appList}))})},n.appStop=function(e,t){x.stopApp({id:e}).then(function(e){200==e.code&&(t.state=0,n.setState({appList:n.state.appList}))})},n.appDel=function(e){var t=Object(h.a)(Object(h.a)(n));T({title:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u5e94\u7528?",content:"\u4e00\u65e6\u5220\u9664\u65e0\u6cd5\u6062\u590d",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){x.deleteApp({id:e}).then(function(e){200==e.code&&t.selectAppList()})},onCancel:function(){console.log("Cancel")}})},n.columns=[{title:"\u5e94\u7528\u540d",dataIndex:"name"},{title:"\u9879\u76ee\u6587\u4ef6",dataIndex:"fileName"},{title:"\u5e94\u7528\u72b6\u6001",dataIndex:"state",render:function(e,t){return s.a.createElement("span",null,n.printState(e))}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime"},(a={title:"\u64cd\u4f5c",dataIndex:"state"},Object(f.a)(a,"dataIndex","id"),Object(f.a)(a,"render",function(e,t){return s.a.createElement("span",null,n.printOperation(t))}),a)],n.showModal=function(e,t){if(0==e)n.state.modal.title="\u6dfb\u52a0\u5e94\u7528";else if(1==e){n.state.modal.title="\u4fee\u6539\u5e94\u7528",x.getApp({id:t}).then(function(e){if(200==e.code){var t=e.data,a=[{uid:"1",name:t.fileName,status:"done",response:"Server Error 500",url:""}],s={id:t.id,name:t.name,fileName:a};n.setState({app:s})}})}n.setState({visible:!0})},n.handleOk=function(e){if(null!=n.state.app.name&&""!=n.state.app.name)if(n.state.app.fileName.length<1)j.msg({code:400,message:"\u8bf7\u4e0a\u4f20\u6587\u4ef6"});else{var t={id:n.state.app.id,name:n.state.app.name,fileName:n.state.app.fileName[0].name};x.saveApp(t).then(function(e){200==e.code&&(n.selectAppList(),n.setState({visible:!1,app:{id:"",name:"",fileName:""}}))})}else j.msg({code:400,message:"\u8bf7\u7f16\u8f91\u5e94\u7528\u540d\u79f0"})},n.handleCancel=function(e){n.setState({visible:!1,app:{id:"",name:"",fileName:""}})},n.sousuo=function(e){n.state.appList.name=e,n.selectAppList()},n.handleTableChange=function(e,t,a){n.state.appList.current=e.current,n.selectAppList()},n.handleInput=function(e){n.setState({app:{id:n.state.app.id,name:e.target.value,fileName:n.state.app.fileName}})},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.selectAppList()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(I,{placeholder:"\u641c\u7d22",onSearch:this.sousuo,style:{width:200,marginBottom:"15px"}}),s.a.createElement(A.a,{type:"primary",ghost:!0,onClick:function(){return e.showModal(0)}},s.a.createElement(b.a,{type:"plus"}),"\u6dfb\u52a0\u5e94\u7528")),s.a.createElement(y.a,{columns:this.columns,dataSource:this.state.pagination.records,pagination:this.state.pagination,loading:this.state.loading,onChange:this.handleTableChange,size:"small"}),s.a.createElement(g.a,{title:this.state.modal.title,visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a"},s.a.createElement(v.a,{onSubmit:this.handleSubmit},s.a.createElement(M,Object.assign({},W,{label:"\u5e94\u7528\u540d\u79f0\uff1a"}),s.a.createElement(E.a,{onChange:this.handleInput,value:this.state.app.name})),s.a.createElement(M,Object.assign({},W,{label:"\u9879\u76ee\u6587\u4ef6\uff1a"}),s.a.createElement(w.a,{onChange:this.handleChange,fileList:this.state.app.fileName,action:"/aptsApp/uploadAppFile",headers:z},s.a.createElement(A.a,null,s.a.createElement(b.a,{type:"upload"})," \u4e0a\u4f20jar\u5305"))))))}}]),t}(n.Component),B=a(413),H=a(406),P=(B.a.Header,B.a.Content),J=B.a.Footer,U=B.a.Sider,F=(H.a.SubMenu,function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(o.a)(this,Object(r.a)(t).call(this,e))).onCollapse=function(e){console.log(e),a.setState({collapsed:e})},a.state={collapsed:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(B.a,{style:{minHeight:"100vh"}},s.a.createElement(U,{collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},s.a.createElement("div",{className:"logo"}),s.a.createElement(H.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"},s.a.createElement(H.a.Item,{key:"1"},s.a.createElement(u.a,{to:"/app"},s.a.createElement(b.a,{type:"pie-chart"}),"\u5e94\u7528\u7ba1\u7406")),s.a.createElement(H.a.Item,{key:"2"},s.a.createElement(u.a,{to:"/app"},s.a.createElement(b.a,{type:"pie-chart"}),"\u5168\u5c40\u914d\u7f6e")),s.a.createElement(H.a.Item,{key:"3"},s.a.createElement(u.a,{to:"/app"},s.a.createElement(b.a,{type:"pie-chart"}),"\u5de5\u5177\u914d\u7f6e")),s.a.createElement(H.a.Item,{key:"4"},s.a.createElement(u.a,{to:"/app"},s.a.createElement(b.a,{type:"pie-chart"}),"\u7528\u6237\u7ba1\u7406")),s.a.createElement(H.a.Item,{key:"5"},s.a.createElement(u.a,{to:"/app"},s.a.createElement(b.a,{type:"pie-chart"}),"\u4e2a\u4eba\u4e2d\u5fc3")))),s.a.createElement(B.a,null,s.a.createElement(P,{style:{margin:"16px 16px 0px 16px"}},s.a.createElement("div",{style:{padding:24,background:"#fff",minHeight:"85vh"}},s.a.createElement(d.a,{path:"/app",component:D}))),s.a.createElement(J,{style:{textAlign:"center"}})))}}]),t}(n.Component)),K=function(e){function t(){return Object(p.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.match.params.appId;document.title="\u5b9e\u65f6\u65e5\u5fd7\u76d1\u63a7",new WebSocket(N.wsUrl+"/AptsAppLogWs/"+e).onmessage=function(e){var t=e.data;document.getElementById("log").innerHTML+=t}}},{key:"render",value:function(){return s.a.createElement("span",{id:"log"})}}]),t}(n.Component),$=a(415),q=a(416);i.a.render(s.a.createElement($.a,null,s.a.createElement("div",null,s.a.createElement(d.a,{path:"/",render:function(){return s.a.createElement("div",null,s.a.createElement(q.a,null,s.a.createElement(d.a,{path:"/log/:appId",component:K}),s.a.createElement(d.a,{path:"/",component:F})))}}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[190,2,1]]]);
//# sourceMappingURL=main.9b50bc97.chunk.js.map